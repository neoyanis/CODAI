function generateCode() {
  const prompt = document.getElementById("prompt").value.toLowerCase();
  const lang = document.getElementById("language").value;
  const out = document.getElementById("output");

  const isFR = prompt.includes("je") || prompt.includes("carte") || prompt.includes("fpga");
  const header = isFR
    ? "// Code généré par Constance AI (FR)\n\n"
    : "// Code generated by Constance AI (EN)\n\n";

  let code = "";

  if (lang === "verilog") code = header + verilogCode();
  if (lang === "vhdl")    code = header + vhdlCode();
  if (lang === "arduino") code = header + arduinoCode();
  if (lang === "cpp")     code = header + cppCode();
  if (lang === "html")    code = header + htmlCode();

  out.textContent = code;
}

function copyCode() {
  navigator.clipboard.writeText(
    document.getElementById("output").textContent
  );
  alert("Code copied");
}

/* ===== REAL CODE GENERATORS ===== */

function verilogCode() {
return `
module top (
  input wire clk,
  input wire a,
  input wire b,
  output reg y
);
  always @(posedge clk) begin
    y <= a & b;
  end
endmodule
`;
}

function vhdlCode() {
return `
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity top is
  Port (
    clk : in STD_LOGIC;
    a   : in STD_LOGIC;
    b   : in STD_LOGIC;
    y   : out STD_LOGIC
  );
end top;

architecture Behavioral of top is
begin
  process(clk)
  begin
    if rising_edge(clk) then
      y <= a and b;
    end if;
  end process;
end Behavioral;
`;
}

function arduinoCode() {
return `
void setup() {
  pinMode(13, OUTPUT);
}

void loop() {
  digitalWrite(13, HIGH);
  delay(500);
  digitalWrite(13, LOW);
  delay(500);
}
`;
}

function cppCode() {
return `
#include <iostream>
using namespace std;

int main() {
  cout << "Hello from Constance AI" << endl;
  return 0;
}
`;
}

function htmlCode() {
return `
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Generated by Constance AI</title>
  <style>
    body {
      background:black;
      color:red;
      font-family:Arial;
      text-align:center;
      padding-top:40px;
    }
    button {
      background:red;
      color:white;
      border:none;
      padding:10px 20px;
      border-radius:8px;
    }
  </style>
</head>
<body>
  <h1>Hello World</h1>
  <button>Click</button>
</body>
</html>
`;
}
